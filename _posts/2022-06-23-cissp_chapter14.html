---
layout: post
title: Chapter 14 Controlling and Monitoring Access
subtitle: 
date: 2022-06-23 00:03:00 +0900
cover-img: [/assets/img/cover/security1.jpg, /assets/img/cover/security2.jpg, /assets/img/cover/security3.jpg]
thumbnail-img: https://i.imgur.com/Se6UFV3.png
share-img:
tags: [CISSP]
categories: [Security, Study]
---

<!-- wp:heading -->
<h2>Comparing Access Control Models</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>A subject is an active entity that accesses a passive object.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>An object is a passive entity that provides information to active subjects.</p>
<!-- /wp:paragraph -->

<img src="https://i.imgur.com/Se6UFV3.png">

<!-- wp:list -->
<ul><li>Permissions (権限)</li><li>Refer to the access granted for an object and determine what you can do with it.</li><li>Rights (権利)<ul><li>Refer to the ablility to take an action on an object.</li><li>例 : 社长有权利把这个业务关停</li></ul></li><li>Privileges (特権)</li><li>A combination of rights and Permissions.</li><li>例 : root / administrator</li><li>Understanding Authorization Mechanisms (了解授权机制)</li><li>Implicit Deny (隐式拒绝)<ul><li>A fundamental principle of access control is IMPLICIT DENY.</li><li>As deny by default.</li></ul></li><li>Access Control Matrix</li><li>Capability Tables<ul><li>Difference between an ACL and a capability table</li><li>ACLs are object focused and identify access granted to subjects for any specific object.</li><li>Capability tables are subject focused and identify the objects that subjects can access.</li></ul></li><li>Constrained Interface<ul><li>Apps use contrained or restricted interface to restrict what users can do or see based on their privileges.</li></ul></li><li>Content-Dependent Control<ul><li>Restrict access to data based on the content within an object. (Like a DB view table)</li></ul></li><li>Context-Dependent Control (上下文相关控制)</li><li>Need to Know</li><li>Least Privilege (最小特权)</li><li>Seperation of Duties and Responsibilities (职责分离)<ul><li>Ensure that sensitive functions are split into tasks performed by two or more employees.</li></ul></li><li>Defining Requirements with a Security Policy (使用安全策略定义需求)</li><li>Policy usually does not go into details about how to fulfill the security needs or how to implement the policy.</li><li>Professionals use the security policies as a guide to implement security requirement.</li><li>Introducing Access Control Models</li><li>Discretionary Access Control (DAC : 自主访问控制 / 任意アクセス制御)<ul><li>Every object has an owner.</li><li>The owner can grant or deny access to any other subjects.</li><li>UNIX/ Windows's security model.</li></ul></li><li>Role-Based Access Control (RBAC : 基于角色的访问控制 / ロールベースのアクセス制御)<ul><li>Uses rols or groups.</li><li>User accounts are placed in roles and administrators assigned privileges to the roles.</li></ul></li><li>Rule-Based Access Control ( 基于规则的访问控制 / ルールベースのアクセス制御)<ul><li>Applies global rules to all subjects.</li><li>e.g. firewall.</li></ul></li><li>Attribute-Based Access Control (ABAC : 基于属性的访问控制 / 属性ベースのアクセス制御)<ul><li>Rules can include multiple attributes.</li><li>Be much more flexible than a rule-based access control model.</li></ul></li><li>Mandatory Access Control (MAC : 强制访问控制 / 強制アクセス制御)<ul><li>Use of labels applied to both subjects and objects.</li></ul></li><li>Risk-Based Access Control (基于风险的访问控制 / リスクベースのアクセス制御)<ul><li>Grants access after evaluating risk.</li><li>Uses ML to make predictive conclustions about current activity based on past activity.</li></ul></li><li>Discretionary Access Control</li><li>A DAC model is implemented using access control lists (ACLs) on object.</li><li>Nondiscretionary Access Control (Non-DAC)</li><li>The mojor difference b/w DAC and Non-DAC -&gt; How they are controlled and managed.<ul><li>Non-DAC</li><li>Centrally administer</li><li>Changes affect the entire environment.</li><li>Essier to manager</li><li>Less flexible</li><li>DAC</li><li>Allow owners to make their own changes.</li><li>Changes don't affect other parts of the environment</li><li>Diffitcal to manager</li><li>More flexible</li></ul></li><li>Non-DAC models<ul><li>Role-Based Access Control (RBAC)</li><li>Preventing privilege creep.</li><li>It is chanllenging to identify and revoke all of a user's unneeded privileges when privileges are assigned to users directly.</li><li>Task-based access control (TBAC) is similar to RBAC.<ul><li>Each user is assigned an array of tasks.</li></ul></li><li>Rule-Based Access Control</li><li>DO NOT abbreviated as RBAC!</li><li>Firewall<ul><li>The last rule might be deny all.</li></ul></li><li>Attribute-Based Access Control (ABAC)</li><li>An advanced implementation of a rule-based access crontrol.</li><li>Many SDN applications use ABAC medels:</li><li>Rule-based access control applies to all users, but the ABAC can be much more specific.</li><li>Mandatory Access Controls (MAC)</li><li>A security domain is a collection of subjects and objects that share a common security policy.</li><li>Is prohibitive rather than permissive, and it uses an implicit deny philosophy.</li><li>Is more secure than the DAC model, but it isn't as flexible or scalable.</li><li>Key point<ul><li>Every object and every subject has one or more labels.</li><li>These labels are predefined.</li><li>The System determines access based on assigned lebels.</li></ul></li><li>Three types of environment<ul><li>Hierarchical Environment (分层环境)</li><li>e.g. Someone with a Top secret clearance can accesss Top Secret data and Secret data.</li><li>Compartmentalized Environment (分隔环境)</li><li>The subject must have specific chearance for the object's security domain.</li><li>Hybrid Environment</li><li>Provides granular control over access but becomes increasingly difficult to manage as it grows.</li></ul></li><li>Rule-Based Access Control</li><li>Several different elements considered:<ul><li>The environment</li><li>The situation</li><li>Security policies</li></ul></li><li>Two other things<ul><li>Multifactor Authentication</li><li>Compliant Mobile Devices</li></ul></li></ul></li></ul>
<!-- /wp:list -->

<!-- wp:heading -->
<h2>Implementing Authentication Systems</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><li>Implementing SSO on the internet</li><li>XML<br>Many cloud-based providers use XML-based languages to share information for authentication and authorization.</li><li>SAML (Security Assertion Markup Language)<ul><li>Three entities</li><li>Principal or User Agent</li><li>Service Provider(SP)</li><li>Identity Provider(IdP)</li><li>Three types of XML messages (assertions) send by IdP</li><li>Authentication Assertion (认证声明)</li><li>Authorization Assertion</li><li>Attribute Assertion</li><li>SAML is a popular SSO standard on the internet, and is used to exchange AA information.</li></ul></li><li>OAuth 2.0 (Open Authorization)<ul><li>Authorization token is used.</li><li>Doesn't provide authentizaton.</li><li>OAuth 2.0 is not backward compatible with OAuth 1.0</li><li>It exchanges API messages and uses a token ot show that access is authorized.</li></ul></li><li>OpenID<ul><li>Maintained by the OpenID Foundation.</li><li>User -&gt; Relying Party(RP) -&gt; OpenID provider</li></ul></li><li>OIDC (OpenID Connect)<ul><li>Maintained by the OpenID Foundation too.</li><li>OIDC uses the OAuth framework for authorization and builds on the OpenID technologies for authentication. OIDC uses JSON Web Tokens.</li></ul></li><li>Comparing SAML, OAuth, OpenID, and OIDC<ul><li>https://guaiguailei.net/security/comparing-saml-oauth-openid-oidc</li></ul></li><li>Implementing SSO on Internal Network</li><li>AAA Protocols<ul><li>Protocols provide authentication, authorization, and accounting.</li><li>Protect internal LAN authentication systems and other servers from remote attacks.</li></ul></li><li>Kerberos (ケルベロス / カーベロス)<ul><li>The most common and well-known ticket system.</li><li>Using the AES (Advanced Encryption Standard)</li><li>Provides confidentiality and integrity for authentication.</li><li>Helps protect against eavesdropping and replay attacks.</li><li>Uses several different elements:</li><li>Key Distribution Center (KDC : 密钥分发中心)<ul><li>All clients and servers are registered with the KDC.</li><li>Maintains the secret keys for all network members.</li></ul></li><li>Kerberos Authentication Server<ul><li>Ticket-Granting Service (TGS : 票据授权服务) # can be hosted on another server</li><li>Authentication Service (AS : 认证服务)</li></ul></li><li>Ticket<ul><li>Is an encrypted message that provides proof that a subject is authorized to access an object.</li><li>Sometimes called a Service Ticket (ST)</li></ul></li><li>Ticket-Granting-Ticket (TGT)<ul><li>Provides proof that a subject has authenticated through a KDC and is authorized to request tickets to access other objects.</li></ul></li><li>Kerberos Principal</li><li>Kerberos Realm</li></ul></li><li>RADIUS (Remote Authentication Dial-In User Service)<ul><li>The RADIUS server also provides AAA services for multiple remote access servers.</li><li>Many internet service providers (ISPs) use RADIUS for authentication.</li><li>Uses UDP by default and encrypts only the password's exchange.</li><li>When using TLS, RADIUS uses TCP port 2083. RADIUS uses UDP port 1812 for RADIUS messages and UDP port 1813 for RADIUS Accounting messages.</li><li>RADIUS/TLS<br>TLS encrypton for RADIUS over TCP (RadSec)</li><li>RADIUS provides AAA services between network access servers and a shared authentication server. The network access server is the client of the RADIUS authentication server.</li></ul></li><li>TACACS+ (Terminal Access Controller Access-Control System Plus)<ul><li>Encrypts all of the authentication information, not just the password, as RADIUS does.</li><li>Uses TCP port 49.</li></ul></li></ul>
<!-- /wp:list -->

<!-- wp:heading -->
<h2>Understanding Access Control Attacks</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><li>Crackers, Hackers, and Attackers</li><li>Crackers (破解者 / クラッカー)<ul><li>Are malicious individuals who are intent on waging an attack against a person or system.</li><li>In many situations, crackers are simply criminals.</li></ul></li><li>Hackers (黑客 / ハッカー)</li><li>Risk Elements</li><li>A threat is a potential occurrence that can result in an undesirable outcome. (威胁是可能导致不良结果的潜在事件)</li><li>Common Access Control Attacks</li><li>Privilege Escalation (权限提升)<ul><li>Privilege escalation is often described as horizontal privilege escalation and vertical privilege escalation.</li><li>Horizontal privilege escalation</li><li>Gains similar privileges as the first compromised user, but from other accounts.</li><li>Vertical privilege escalation</li><li>Gains significantly greater privileges<ol><li>Use vertical privilege escalation techniques to gain administrator privileges on the user's computer.</li><li>Use horizontal privilege escalation techniques to access ohter computers in the network ("lateral movement" / 横向运动).</li></ol></li></ul></li><li>Using the su and sudo Commands<ul><li>su command</li><li>sudo command</li></ul></li><li>Minimizing the Use of sudo</li><li>Privilege Escalation with PowerShell<ul><li>Many Windows systems have PowerShell installed by default.</li><li>Whenever possible, it's best to create a service account instead of using the local system account.</li></ul></li><li>Password Attacks<ul><li>Passwords are the weakest form of authentication.</li><li>It's important to change default passwords.</li><li>Account databases can be Windows-based Security Account Manager (SAM) file or the /etc/shadow file on Linux systems.</li></ul></li><li>Dictionary Attack (字典攻击)<ul><li>Using a predefined database or list of common or expected passwords.</li><li>one-upped-constructed passwor (单构密码)</li></ul></li><li>Brute-Force Attack (暴力攻击)<ul><li>Is an attempt to discover passwords for user accounts by systematically attempting all possible combinations of letters, numbers, and symboles.</li><li>Comparative Analysis / Reverse-hash Matching</li><li>Repeating the process that guesses password and calculating the hash of it then to compare it against the stored hash in the offline database.</li><li>Better hashing functions are collision resistant.</li></ul></li><li>Spraying Attack (喷洒攻击)<ul><li>Attacks in online password attacks, attempting to bypass account lockout security controls.</li><li>Similar to Reverse Brute-Force Attack</li></ul></li><li>Credential Stuffing Attack<ul><li>Only checks a single username and password on each site.</li></ul></li><li>Birthday Attack<ul><li>Focuses on finding collisions. Its name comes from a statistical phenomenon known as the birthday paradox.</li><li>The birthday paradox states that if there are 23 people in a room, there is a 50 percent chance that any two of them will have the same birthday.</li></ul></li><li>Rainbow Table Attack<ul><li>Precomputed hashes raindow table is very large in size.</li><li>A salt is a group of random bits added to a password before hashing it.</li><li>Adding a pepper to a salted password increases the security, making it more difficult to crack.</li><li>A pepper is a large constant number stored outside the DB holding the salted, hashed passwords, such as a configuration value on a server or a constant stored within application code.</li></ul></li><li>Mimikatz<ul><li>Benjamin Delpy created Mimikatz in 2007 to perform some experiments in Windows security while learning C.</li><li>SSO methods store credentials in memory, and Mimikatz exploits this by reading memory credentials.</li><li>Some capabilities of Mimikatz:</li><li>Read passwords from memory.</li><li>Extract Kerberos Tickets.</li><li>Extract Certificates and Private Keys.</li><li>Read LM and NTLM Password Hashes in Memory.</li><li>Read Cleartext Passwords in Local Security Authority Subsystem Service (LSASS).</li><li>List Running Processes.</li><li>Attackers can run Mimikatz as fileless malware on remote systems.</li></ul></li><li>Pass-the-Hash Attack (PtH Attack)<ul><li>Allows an attacker to send a captured hash of a password to an authenticating service.</li><li>The best protection is to prevent the infection of the first computer.</li></ul></li><li>Kerberos Exploitation Attack<ul><li>Includes the following:</li><li>Overpass the Hash</li><li>Pass the Ticket</li><li>Silver Ticket</li><li>Golden Ticket</li><li>Kerberos Brute-Force</li><li>ASREPRoast</li><li>Kerberoasting</li></ul></li><li>Sniffer Attack (嗅探器攻击 / 盗聴攻撃 / スニファー攻撃 / スニファーアタック)<ul><li>Wireshark tool</li><li>To prevent successful sniffing attacks:</li><li>Encrypt all sensitive data.</li><li>Avoid the use of insecure protocols and use secure protocols.</li><li>Use onetime passwords when encryption is not possible or feasible.</li><li>Protect network devices with physical security.</li><li>Monitor the network for signatures from sniffers.</li></ul></li><li>Spoofing Attacks<ul><li>IP spoofing attack</li><li>Replace a valid source IP address.</li><li>Email spoofing attack</li><li>Spoof the email address in the From field.</li><li>Phone Number spoofing attack</li><li>Replace the actual calling number with a phone number that includes the same area code as the called number.</li></ul></li><li>Core Protection Methods</li><li>Control physical access to systems</li><li>Control electronic access to files.</li><li>Hash and salt passwords.<ul><li>Argon2, bcrypt, PBKDF2</li></ul></li><li>Use password masking.</li><li>Deploy Multifactor authenticating.</li><li>Use account lockout controls.</li><li>Use last logon notification.</li><li>Educate users about security.</li></ul>
<!-- /wp:list -->

<!-- wp:heading -->
<h2>Summary</h2>
<!-- /wp:heading -->

<!-- wp:heading -->
<h2>Exam Essentials</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul><li>Identify common authorization mechanisms.</li><li>Describe key concepts of the Discretionary Access Control (DAC) model.</li><li>Describe key concepts of the Role-Based Access Control (RBAC) model.</li><li>Describe key concepts of the rule-based access control model.</li><li>Describe key concepts of the Attribute-Based Access Control (ABAC) model.</li><li>Describe key concepts of the Mandatory Access Control (MAC) model.</li><li>Describe key concepts of the risk-based access control model.</li><li>Understand single sign-on methods used on the internet.</li><li>Describe Kerberos.</li><li>Understand the purpose of AAA protocols.</li><li>Describe privilege escalation.</li><li>Know about pass-the-hash attacks.</li><li>Know about Kerberos exploitation attacks.</li><li>Know how brute-force and dictionary attacks work.</li><li>Understand how salt and pepper thwart password attacks.</li><li>Understand sniffer attacks.</li><li>Understand spoofing attacks.</li></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>Review Questions:</p>
<!-- /wp:paragraph -->

<!-- wp:code -->
<pre class="wp-block-code"><code>1 B
2 B
3 B
4 A
5 D
6 A
7 D
8 B
9 B
10 B
11 C
12 D → A
13 A
14 A
15 D
16 C
17 C → B
18 B
19 D
20 C</code></pre>
<!-- /wp:code -->

<!-- wp:paragraph -->
<p>正解率：18 / 20 = 90%</p>
<!-- /wp:paragraph -->
